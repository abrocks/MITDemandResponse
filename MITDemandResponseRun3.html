<html>
        <head>
          <script src="datAll.js"></script>
          <script src= "Bid.js"></script>
          <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
          <script type="text/javascript">
          
          //the citation for this format is here
          //WHERE?? 
          var graphableArrayLine = ALLDATA.map(function(element){
                  var intermediate = {};
                  intermediate.x = element[1]+'/'+element[2];
                  intermediate.y = element[6]; 
                  return intermediate; 
                  //output should be {month/day/year/hour, profit, LMP}
                });
            var graphableArrayArea = ALLDATA.map(function(element){
                var intermediate = {};
                intermediate.x = element[1]+'/'+element[2];
                if(element[6]>BidPrice){intermediate.y = BidMW*(element[6]-BidPrice)}
                else{intermediate.y = 0}
                return intermediate; 
                  //output should be {month/day/year/hour, profit, LMP}
                });     
                
            window.onload = function () {

            var chart = new CanvasJS.Chart("chartContainer", {
                animationEnabled: true,
                theme: "light2",
                title: {
                    text: "MIT Demand Response Profitability"
                },
                axisX: {
                    valueFormatString: "MMM"
                },
                axisY: {
                    prefix: "$",
                    labelFormatter: addSymbols
                },
                toolTip: {
                    shared: true
                },
                legend: {
                    cursor: "pointer",
                    itemclick: toggleDataSeries
                },
                data: [
                    /*
                {
                    type: "column",
                    name: "Actual Sales",
                    showInLegend: true,
                    xValueFormatString: "MMMM YYYY",
                    yValueFormatString: "$#,##0",
                    dataPoints: [
                        { x: new Date(2016, 0), y: 20000 },
                    ]
                }, 
                */ 
                {
                    type: "line",
                    name: "LMP",
                    showInLegend: true,
                    //yValueFormatString: "$#,##0",
                    dataPoints: graphableArrayLine
                },
                {
                    type: "area",
                    name: "Profit",
                    markerBorderColor: "white",
                    markerBorderThickness: 2,
                    showInLegend: true,
                    //yValueFormatString: "$#,##0",
                    dataPoints: graphableArrayArea
                }]
            });
            chart.render();
            
            function addSymbols(e) {
                var suffixes = ["", "K", "M", "B"];
                var order = Math.max(Math.floor(Math.log(e.value) / Math.log(1000)), 0);
                if(order > suffixes.length - 1)                	
                    order = suffixes.length - 1;
                var suffix = suffixes[order];      
                return CanvasJS.formatNumber(e.value / Math.pow(1000, order)) + suffix;
            }

            function toggleDataSeries(e) {
                if (typeof (e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
                    e.dataSeries.visible = false;
                } else {
                    e.dataSeries.visible = true;
                }
                e.chart.render();
            }
}
</script>
</head>

<body>
    <div id="chartContainer" style="height: 370px; width: 100%;"></div>
</body>
</html>

        
      

